<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Olive: Chatbot</title>
    <link rel="stylesheet" href="style/style.css">
</head>

<body>
    <header>
        <h1>OLIVE</h1>
        <button><i class="fa fa-whatsapp"></i></button>
    </header>
    <main id="chat-section">
        <div class="chat-bubble user-bubble">
            Hey Olive!
        </div>
        <div class="chat-bubble olive-bubble">
            Hey wassup how may I help you today!
        </div>
    </main>
    <div id="prompt-entry-container">
        <div id="prompt-entry">
            <textarea type="text" name="prompt" id="prompt"></textarea>
            <button id="send-btn" type="submit"><i class="fa fa-send"></i></button>
        </div>
    </div>
</body>


<script>
    const chatSection = document.getElementById("chat-section");
    const sendBtn = document.getElementById("send-btn");
    const promptEntry = document.getElementById("prompt")

    const API_KEY = "AIzaSyADs4_gyHxFPv8BbHkOJQ9D6jywdnlFyDQ"
    const API_REQUEST_URL = `https://generativelanguage.googleapis.com/v1/models/gemini-2.0-flash:generateContent?key=${API_KEY}`

    let userPrompt = ""

    sendBtn.addEventListener("click", () => {
        userPrompt = promptEntry.value.trim();
        promptEntry.value = ""
        addBubble("user", userPrompt)
        processPrompt()
    })

    function addBubble(sender, message) {
        const bubble = document.createElement("div")
        bubble.classList.add("chat-bubble")
        if (sender === "user") {
            bubble.classList.add("user-bubble")
        } else if (sender === "olive") {
            bubble.classList.add("olive-bubble")
        }
        bubble.textContent = message
        chatSection.appendChild(bubble)
    }

    async function processPrompt() {
        let reply = await askGemini(userPrompt);
        addBubble("olive", )
    }

    async function askGemini(p) {
        const res = await fetch(
            API_REQUEST_URL,
            {
                method:"POST",
                headers:{"Content-Type":"application/json"},
                body:JSON.stringify(
                    {
                        contents:[{parts:[{text: p}]}], 
                    }),
            });
        const data = await res.json();
        let ret = data?.candidates?.[0]?.content?.parts?.[0]?.text;
        return ret;
    }
</script>

</html>